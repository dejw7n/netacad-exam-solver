var vds=new function(a){this.getObjectByName=function(b){for(var c=a,b=b.split("."),d;d=b.shift();)if(c[d])c=c[d];else return null;return c===a?null:c};this.provide=function(b){if(this.getObjectByName(b))throw Error('"'+b+'" already provided.');for(var c=a,b=b.split("."),d;d=b.shift();)c[d]=c[d]||{},c=c[d]};this.extend=function(a,c){a.prototype=Object.create(c.prototype||c,{constructor:{value:a,writable:!0,configurable:!0,enumerable:!1}})}}(window);vds.provide("vds.events");
vds.events.Event=function(a){this.type=a;this.currentTarget=this.target=null};vds.events.EventTarget=function(){this.listeners={}};vds.events.EventTarget.prototype.addEventListener=function(a,b){a&&b&&(this.removeEventListener(a,b),a in this.listeners||(this.listeners[a]=[]),this.listeners[a].push(b))};vds.events.EventTarget.prototype.removeEventListener=function(a,b){if(a&&b&&a in this.listeners){var c=this.listeners[a],d=c.indexOf(b);0<=d&&c.splice(d,1);0==c.length&&delete this.listeners[a]}};
vds.events.EventTarget.prototype.dispatchEvent=function(a){if(a&&a.type&&a.type in this.listeners){a.currentTarget=this;a.target||(a.target=this);for(var b=this.listeners[a.type],c=0;c<b.length;c++){var d=b[c];d instanceof Function?d.call(this,a):d.handleEvent&&d.handleEvent(a)}}};vds.Cache=function(){var a={};this.get=function(b){return a[b]};this.set=function(b,c){a[b]=c};this.has=function(b){return a.hasOwnProperty(b)};this.remove=function(b){delete a[b]};this.clear=function(){a={}}};
vds.cache=new vds.Cache;vds.provide("vds.date");vds.date.formatTime=function(a){var b=Math.floor(a%36E5/6E4),c=Math.floor(a%6E4/1E3);return("00"+Math.floor(a/36E5)).slice(-2)+":"+("00"+b).slice(-2)+":"+("00"+c).slice(-2)};
vds.date.formatMinutes=function(a){var b=Math.floor(a/60/24),c=Math.floor(a/60)%24,a=a%60,d="";0<b&&(d+=b,d=1<b?d+(" "+vds.cache.get("TIME_DAYS")):d+(" "+vds.cache.get("TIME_DAY")));0<c&&(d+=c,d=1<c?d+(" "+vds.cache.get("TIME_HOURS")):d+(" "+vds.cache.get("TIME_HOUR")));0<a&&(d+=a,d=1<a?d+(" "+vds.cache.get("TIME_MINUTES")):d+(" "+vds.cache.get("TIME_MINUTE")));return d};vds.provide("vds.dom");vds.dom.empty=function(a){for(;a.hasChildNodes();)a.removeChild(a.lastChild);return a};
vds.dom.preload=function(a){Image&&((new Image).src=a)};vds.dom.hide=function(a){a.style.display="none"};vds.dom.show=function(a){a.style.display=null};vds.provide("vds.http");
vds.http.get=function(a,b,c,d){try{var e=Object.keys(b).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(b[a])}).join("&");e&&(a+="?"+e);var f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==f.readyState)if(200==f.status){var b=null;try{b=d?f.responseText:JSON.parse(f.responseText)}catch(g){c(g);return}c(null,b)}else c(Error("unable to get "+a))};f.open("GET",a);f.timeout=1E4;f.send()}catch(g){c(g)}};
vds.http.post=function(a,b,c,d){try{var e=Object.keys(b).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(b[a])}).join("&"),f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==f.readyState)if(200==f.status){var b=null;try{b=d?f.responseText:JSON.parse(f.responseText)}catch(g){c(g);return}c(null,b)}else c(Error("unable to post "+a))};f.open("POST",a);f.setRequestHeader("Content-Type","application/x-www-form-urlencoded");f.timeout=1E4;f.send(e)}catch(g){c(g)}};
vds.http.postSafari=function(a,b,c,d,e){MAXRETRIES=10;e=e||0;try{var f=Object.keys(b).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(b[a])}).join("&"),g=new XMLHttpRequest;g.onreadystatechange=function(){if(4==g.readyState)if(200==g.status){var f=null;try{f=d?g.responseText:JSON.parse(g.responseText)}catch(h){c(h);return}c(null,f)}else 0==g.status&&e<MAXRETRIES?(e+=1,setTimeout(function(){vds.http.postSafari(a,b,c,d,e)},100*e)):c(Error("unable to post "+a))};g.open("POST",a);
g.setRequestHeader("Content-Type","application/x-www-form-urlencoded");g.setRequestHeader("cache-control","no-cache");g.timeout=1E4;g.send(f)}catch(h){c(h)}};
vds.logger=new function(a){this.level={};Object.defineProperty(this.level,"ALL",{enumerable:!0,value:-Infinity});Object.defineProperty(this.level,"DEBUG",{enumerable:!0,value:1E4});Object.defineProperty(this.level,"INFO",{enumerable:!0,value:2E4});Object.defineProperty(this.level,"WARN",{enumerable:!0,value:3E4});Object.defineProperty(this.level,"ERROR",{enumerable:!0,value:4E4});Object.defineProperty(this.level,"FATAL",{enumerable:!0,value:5E4});Object.defineProperty(this.level,"OFF",{enumerable:!0,
value:Infinity});var b=this.level.INFO;a.console||(a.console={});var c=a.console;c.log||(c.log=function(){});c.debug||(c.debug=c.log);c.info||(c.info=c.log);c.warn||(c.warn=c.log);c.error||(c.error=c.log);this.getLevel=function(){return b};this.setLevel=function(a){if("number"!==typeof a)throw Error("value must be a number");b=a};this.log=function(a){b<=this.level.ALL&&c.log(a)};this.debug=function(a){b<=this.level.DEBUG&&c.debug(a)};this.info=function(a){b<=this.level.INFO&&c.info(a)};this.warn=
function(a){b<=this.level.WARN&&c.warn(a)};this.error=function(a){b<=this.level.ERROR&&c.error(a)}}(window);
vds.Template=function(a){if("string"!==typeof a)throw new TypeError("argument must be a string");var b=function(a){return String(a).replace(/[\n\r"'\\\u2028\u2029]/g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})},c="var result = '';\n",c=c+"var print = function (s) { result += s; };\n",c=c+("var encodeJS = "+b.toString()+";\n"),c=c+("var encodeHTML = "+function(a){return String(a).replace(/["&'<>]/g,function(a){return"&#x"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)+
";"})}.toString()+";\n"),c=c+"with (context || {}) {\n",d=0;a.replace(/<#--[\s\S]+?--#>|<#=([\s\S]+?)#>|<#([\s\S]+?)#>|$/g,function(e,f,g,h){c+="result += '"+b(a.slice(d,h))+"';\n";f&&(c+="result += "+f+";\n");g&&(c+=g+"\n");d=h+e.length;return e});c+="}\n";c+="return result;\n";this.render=(new Function("context",c)).bind({})};vds.provide("vds.models");vds.models.Model=function(){vds.events.EventTarget.call(this)};vds.extend(vds.models.Model,vds.events.EventTarget);vds.provide("vds.views");
vds.views.View=function(a,b){vds.events.EventTarget.call(this);this.model=a;if(this.element=b)this.document=this.element.ownerDocument;this.document&&(this.view=this.document.defaultView)};vds.extend(vds.views.View,vds.events.EventTarget);vds.provide("vds.controllers");vds.provide("vds.applications");
(function(a){function b(){for(var a=Array.prototype.slice.call(arguments);a.length;){var b=a.shift();if(""===b)throw new SyntaxError("The string did not match the expected pattern.");if(/\s/.test(b))throw new SyntaxError("The string contains invalid characters.");}}function c(a){this.element=a;for(a=this.element.className.trim().split(/\s+/);a.length;){var b=a.shift();""!==b&&this.push(b)}this.element.className=this.toString()}function d(){return new c(this)}"undefined"!=typeof a&&("Element"in a&&
"document"in a&&!("classList"in a.document.documentElement))&&(c.prototype=[],c.prototype.item=function(a){return this[a]||null},c.prototype.contains=function(a){b(a);return-1!==this.indexOf(a)},c.prototype.add=function(){var a=arguments;b.apply(this,a);for(var c=!1,g=0;g<a.length;g++){var d=a[g];-1===this.indexOf(d)&&(this.push(d),c=!0)}c&&(this.element.className=this.toString())},c.prototype.remove=function(){var a=arguments;b.apply(this,a);for(var c=!1,g=0;g<a.length;g++){var d=this.indexOf(a[g]);
-1!==d&&(this.splice(d,1),c=!0)}c&&(this.element.className=this.toString())},c.prototype.toggle=function(a,c){b(a);if(this.contains(a))return!0!==c?(this.remove(a),!1):!0;if(!1===c)return!1;this.add(a);return!0},c.prototype.toString=function(){return this.join(" ")},Object.defineProperty(a.Element.prototype,"classList",{get:d,enumerable:!0,configurable:!0}))})(window);vds.tasks=new function(){function a(){vds.logger.debug("[vds.tasks] removing completed task");b.shift();b.length?(vds.logger.debug("[vds.tasks] calling next task"),b[0](a)):vds.logger.debug("[vds.tasks] no more tasks")}var b=[];this.add=function(c){if(!(c instanceof Function))throw Error("task is not a function");if(1!==c.length)throw Error("task must be passed a callback function");vds.logger.debug("[vds.tasks] adding task");b.push(c);b[0]===c&&(vds.logger.debug("[vds.tasks] calling first task"),
b[0](a))}};function Core(a){this.name="Core";this.parent=a;this.copyright=this.takeexam=this.manageactivation=this.assessmentactivation=this.dir=null;this.pageItems=[];this.init=function(){this.debug(this.name,"Init");this.dir=document.documentElement.getAttribute("dir")};this.createManageActivation=function(){this.manageactivation=new ManageActivation(this);this.pageItems.push(this.manageactivation)};this.createResourceLink=function(){this.resourcelink=new ResourceLink(this);this.pageItems.push(this.resourcelink)};
this.createExamResultList=function(){this.examresultlist=new ExamResultList(this);this.pageItems.push(this.examresultlist)};this.createActivationSelectList=function(){this.activationselectlist=new ActivationSelectList(this);this.pageItems.push(this.activationselectlist)};this.createAssessmentActivation=function(){this.assessmentactivation=new AssessmentActivation(this);this.pageItems.push(this.assessmentactivation)};this.createAssessmentViewer=function(){this.assessmentviewer=new AssessmentViewer(this);
this.pageItems.push(this.assessmentviewer)};this.updateRender=function(){for(var a=0;a<this.pageItems.length;a++)this.pageItems[a].updateRender()};this.debug=function(a,c){try{console.log("["+(new Date).toISOString()+"]:["+a+"]:"+c)}catch(d){}}}
var dateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=RegExp("\\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\\d{4})?)\\b","g"),c=/[^-+\dA-Z]/g,d=function(a,b){a=String(a);for(b=b||2;a.length<b;)a="0"+a;return a};return function(e,f,g){var h=dateFormat;1==arguments.length&&("[object String]"==Object.prototype.toString.call(e)&&!/\d/.test(e))&&(f=e,e=void 0);e=e?new Date(e):new Date;
if(isNaN(e))throw SyntaxError("invalid date");f=String(h.masks[f]||f||h.masks["default"]);"UTC:"==f.slice(0,4)&&(f=f.slice(4),g=!0);var i=g?"getUTC":"get",k=e[i+"Date"](),l=e[i+"Day"](),m=e[i+"Month"](),p=e[i+"FullYear"](),j=e[i+"Hours"](),q=e[i+"Minutes"](),r=e[i+"Seconds"](),i=e[i+"Milliseconds"](),n=g?0:e.getTimezoneOffset(),s={d:k,dd:d(k),ddd:h.i18n.dayNames[l],dddd:h.i18n.dayNames[l+7],m:m+1,mm:d(m+1),mmm:h.i18n.monthNames[m],mmmm:h.i18n.monthNames[m+12],yy:String(p).slice(2),yyyy:p,h:j%12||
12,hh:d(j%12||12),H:j,HH:d(j),M:q,MM:d(q),s:r,ss:d(r),l:d(i,3),L:d(99<i?Math.round(i/10):i),t:12>j?"a":"p",tt:12>j?"am":"pm",T:12>j?"A":"P",TT:12>j?"AM":"PM",Z:g?"UTC":(String(e).match(b)||[""]).pop().replace(c,""),o:(0<n?"-":"+")+d(100*Math.floor(Math.abs(n)/60)+Math.abs(n)%60,4),S:["th","st","nd","rd"][3<k%10?0:(10!=k%100-k%10)*k%10]};return f.replace(a,function(a){return a in s?s[a]:a.slice(1,a.length-1)})}}();
dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:"Sun Mon Tue Wed Thu Fri Sat Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec January February March April May June July August September October November December".split(" ")};
Date.prototype.format=function(a,b){return dateFormat(this,a,b)};(function(a){var b="assert count debug dir dirxml error exception group groupCollapsed groupEnd info log profile profileEnd table time timeEnd trace warn".split(" "),c=null!==a.location.hostname.match(/netacad\.net$/i);if(!a.console)try{a.console={}}catch(d){}var e;e=!c&&!a.console.log?a.console.log:function(){};for(var f=0,g=b.length;f<g;f++)if(c||!a.console[b[f]])try{a.console[b[f]]=e}catch(h){}})(window);function vdsMessagingDispatch(a){var b=a,c="",d=a.indexOf(":");0<=d&&(b=a.substring(0,d),c=a.substring(d+1,a.length));if("ptclearError"==b)ptclearError();else if("ptdebug"==b)ptdebug(c);else if("ptloadingStatus"==b)c=c.split("###"),ptloadingStatus(c[1],c[2]);else if("ptsetStatus"==b)ptsetStatus(c);else if("ptthrowError"==b){a=[];for(b=c.indexOf("###");0<=b;)d=c.substring(0,b),a.push(d),c=c.substring(b+3),b=c.indexOf("###");a.push(c);ptthrowError(a)}else"ptupdateRender"==b?ptupdateRender():"showDocument"==
b?window.location.assign(c):console.log("Unknown command: "+b)};var vdsMessaging=null;
VdsMessaging=function(){var a=this,b=vds.cache.get("SLIX"),c=vds.cache.get("CLIENT_ID"),d=0,e=null,f=!0;this.connect=function(){e||(e=setInterval(a.getMessages,5E3))};this.disconnect=function(){a.sendMessage("close");if(e){var b=e;e=null;window.clearInterval(b)}};this.getMessages=function(){var d=(new Date).getTime();vds.http.get("/virtuoso/delivery/pub-doc/2.0/messaging/lti.1.0/PTMessageReceive.html",{SLIX:b,CLIENTID:c,TARGET:"WEB_PAGE",CACHEBUSTER:d},function(b,c){b?console.log("getMessages error = "+b):
a.handleMessages(c)},!0)};this.handleMessages=function(a){if(a&&""!==a.trim()){if(f){f=!1;try{clearPtMissingTimeout()}catch(b){}}d=0;for(var a=a.split("\n"),c=0;c<a.length;c++){var e=a[c];"keepalive"!==e&&vdsMessagingDispatch(e)}}else d++,20<=d&&(d=0,console.log("\nLost contact with other end\n"))};this.sendMessage=function(a){var d={TARGET:"PT_PLAYER"};b&&(d.SLIX=b);c&&(d.CLIENTID=c);a&&(d.MESSAGE=a);console.log("sendMessage() "+a);vds.http.postSafari("/virtuoso/delivery/pub-doc/2.0/messaging/lti.1.0/PTMessageSend.html",
d,function(a){a&&console.log("sendMessage error = "+a)},!0)};this.setSlix=function(b){a.slix=b}};var ptapi=new function(){function a(){if(window.SLIX)return window.SLIX;if(location.search){var a=location.search.match(/[\?&]SLIX=([^$&#]*)/);if(a&&a.length)return a[1]}return null}var b=!1,c=!1,d=null,e=null,f="unknown";this.listeners={};this.addEventListener=function(a,b){null==a||(""==a||null==b)||(this.removeEventListener(a,b),a in this.listeners||(this.listeners[a]=[]),this.listeners[a].push(b))};this.removeEventListener=function(a,b){if(!(null==a||""==a||null==b)&&a in this.listeners){var c=
this.listeners[a].indexOf(b);0<=c&&this.listeners[a].splice(c,1);0==this.listeners[a].length&&delete this.listeners[a]}};this.dispatchEvent=function(){if(0!=arguments.length){var a=Array.prototype.slice.call(arguments),b=a.shift();if(b in this.listeners)for(var c=this.listeners[b].slice(0),d=0;d<c.length;d++){var e=c[d];e instanceof Function?e.apply(this,a):e[b]instanceof Function&&e[b].apply(e,a)}}};this.initialize=function(a,c){console.log("PTAPI initialize() called");vdsMessaging=new VdsMessaging;
vdsMessaging.connect();b=!0;this.debug("initialized");vdsMessaging.sendMessage("initialize");c&&c()};this.initializeSystemCheck=function(a,c){console.log("PTAPI initialize() called");vdsMessaging=new VdsMessaging;vdsMessaging.connect();b=!0;this.debug("initialized");c&&c();vdsMessaging.sendMessage("initialize\nstartSystemCheck")};this.skipped=function(a,c){this.debug("skipped");try{if(!b&&e){null==c&&(c="FAKE-"+Date.now());var d=e,d=d+("?mode="+encodeURIComponent(a)),d=d+("&token="+encodeURIComponent(c)),
d=d+"&status=OVERALL_ERROR_055_USER_PTSI_INITIATION_SKIPPED",f=new XMLHttpRequest;f.open("get",d,!1);f.send()}else vdsMessaging.sendMessage("skip:"+a)}catch(l){this.debug(l.message)}};this.checkEnvironment=function(){b?vdsMessaging.sendMessage("checkEnvironment"):this.debug("checkEnvironment called, but PTAPI not initialized")};this.startSystemCheck=function(){b?vdsMessaging.sendMessage("startSystemCheck"):this.debug("startSystemCheck called, but PTAPI not initialized")};this.loadPTItem=function(a,
e){if(b&&(this.debug("loadPTItem: "+a),vdsMessaging.sendMessage("loadPTItem:"+a),c=!0,d=a,e)){var f=function(a){"ready"==a?(this.removeEventListener("status",f),c&&e()):"error"==a&&this.removeEventListener("status",f)};this.addEventListener("status",f)}};this.unloadPTItem=function(a){function e(b){"ready"==b?(this.removeEventListener("status",e),d=null,a&&a()):"error"==b&&this.removeEventListener("status",e)}b&&(this.debug("unloadPTItem"),vdsMessaging.sendMessage("unloadPTItem"),c=!1,this.addEventListener("status",
e),this.dispatchEvent("status"))};this.unload=function(){vdsMessaging.sendMessage("unloadPTItem")};this.startItem=function(){b&&(this.debug("startItem"),vdsMessaging.sendMessage("startItem"))};this.getStatus=function(){if(b)return f};this.initializeStatus=function(){f="unknown"};this.getCurrent=function(){return d};this.debug=function(a){try{console.log("["+(new Date).toISOString()+"]:[PTAPI]:"+a)}catch(b){}};this._setStatus=function(a){f=a;this.debug("setStatus: "+a);this.dispatchEvent("status",
a)};this._loadingStatus=function(a,b,c){this.debug("loadingStatus: "+a+", "+b+", "+c);this.dispatchEvent("loading",a,b,c)};this._updateRender=function(){this.debug("updateRender")};this._throwError=function(a,b){this.debug("throwError: "+a);this.dispatchEvent("error",a,b)};this._clearError=function(){this.debug("clearError");this.dispatchEvent("clear")};this.isLoaded=function(){return c};this.setBaseURL=function(a){e=a.replace(/xpass\/$/,"post-status.html")};this.fetchErrorMessage=function(b,c,d){if(window.XMLHttpRequest){var e=
new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status){var a=e.responseText,b;for(b in c)a=a.replace("${"+b+"}",c[b],"g");d(a)}else d()};var b="/virtuoso/delivery/pub-doc/services/xpass/error_message?ERROR_CODE="+b,f=a();f&&(b+="&SLIX="+f);e.open("GET",encodeURI(b));e.send()}else d()}};function ptdebug(a){ptapi.debug(a)}function ptsetStatus(a){ptapi._setStatus(a)}function ptloadingStatus(a,b,c){ptapi._loadingStatus(a,b,c)}
function ptupdateRender(){ptapi._updateRender()}function ptthrowError(){var a=null,b={},c=Array.prototype.slice.call(arguments,0);if(c.length)for(a=c.shift();c.length;){var d=c.shift(),e=c.shift();b[d]=e}ptapi._throwError(a,b)}function ptclearError(){ptapi._clearError()};var VerticalText=new function(){function a(){if(document&&document.documentElement)for(var a=document.documentElement.style,b=0;b<arguments.length;b++)if(void 0!==a[arguments[b]])return arguments[b];return null}var b=a("transformOrigin","WebkitTransformOrigin","MozTransformOrigin","msTransformOrigin","OTransformOrigin"),c=a("transform","WebkitTransform","MozTransform","msTransform","OTransform"),d=b&&c;this.apply=function(a){if(d&&a instanceof HTMLElement){var f=document.createElement("div");f.style.display=
"block";f.style.position="absolute";for(f.style.whiteSpace="nowrap";a.hasChildNodes();)f.appendChild(a.firstChild);var g=document.createElement("div");g.style.margin="auto";g.style.display="block";g.style.position="relative";g.appendChild(f);a.appendChild(g);var a=f.offsetWidth,h=f.offsetHeight,i=Math.round(100*h/2)/100;g.style.width=h+"px";g.style.height=a+"px";f.style.bottom="0";f.style[b]=i+"px "+i+"px";f.style[c]="rotate(-90deg)"}}};vds.models.Assessment=function(){vds.models.Model.call(this);this.questions=[];this.lastQuestion=this.firstQuestion=this.currentQuestion=null;this.submitted=!1;this.endTime=null};vds.extend(vds.models.Assessment,vds.models.Model);vds.models.Assessment.prototype.addQuestion=function(a){this.firstQuestion||(this.firstQuestion=a);this.questions.push(a);this.lastQuestion&&(this.lastQuestion.nextQuestion=a,a.previousQuestion=this.lastQuestion);this.lastQuestion=a};
vds.models.Assessment.prototype.getCurrent=function(){return this.currentQuestion};vds.models.Assessment.prototype.setCurrent=function(a){this.currentQuestion!=a&&(this.dispatchEvent(new vds.events.Event("beforechange")),this.currentQuestion&&this.currentQuestion.isLoaded()&&this.currentQuestion.setAnswered(this.currentQuestion.hasResponses()),(this.currentQuestion=a)&&this.currentQuestion.setVisited(!0),this.dispatchEvent(new vds.events.Event("change")))};
vds.models.Assessment.prototype.getNext=function(){return this.currentQuestion?this.currentQuestion.nextQuestion:null};vds.models.Assessment.prototype.getPrevious=function(){return this.currentQuestion?this.currentQuestion.previousQuestion:null};
vds.models.Question=function(a,b,c,d,e){vds.models.Model.call(this);this.number=a;this.id=b;this.type=c;this.nextQuestion=this.previousQuestion=null;this._visited=this._loading=this._loaded=!1;this._answered=d||!1;this._ptmo=e||!1;vds.models.Question.map[this.id]=this};vds.models.Question.map={};vds.extend(vds.models.Question,vds.models.Model);vds.models.Question.prototype.isLoaded=function(){return this._loaded};
vds.models.Question.prototype.setLoaded=function(a){this._loaded!=a&&(this._loaded=a,this.dispatchEvent(new vds.events.Event("change")))};vds.models.Question.prototype.isLoading=function(){return this._loading};vds.models.Question.prototype.setLoading=function(a){this._loading!=a&&(this._loading=a,this.dispatchEvent(new vds.events.Event("change")))};vds.models.Question.prototype.isVisited=function(){return this._visited};
vds.models.Question.prototype.setVisited=function(a){this._visited!=a&&(this._visited=a,this.dispatchEvent(new vds.events.Event("change")))};vds.models.Question.prototype.isAnswered=function(){return this._answered};vds.models.Question.prototype.setAnswered=function(a){this._answered!=a&&(this._answered=a,this.dispatchEvent(new vds.events.Event("change")))};vds.models.Question.prototype.hasPTMO=function(){return this._ptmo};
vds.models.Question.prototype.getResponses=function(){return vds.services.responseService.getResponses(Question["AI"+this.id])};vds.models.Question.prototype.hasResponses=function(){return vds.services.responseService.hasResponses(Question["AI"+this.id])};vds.models.Response=function(a,b){vds.models.Model.call(this);this.name=a;this.value=b};vds.extend(vds.models.Response,vds.models.Model);
vds.views.InfoView=function(a,b){vds.views.View.call(this,a,b);if(this.model.endTime){var c=this;this.timeLeftInterval=setInterval(function(){c.updateTimeLeft()},1E3)}this.warned=!1;$("#tenminutewarning").dialog({autoOpen:!1,modal:!0,resizable:!1,draggable:!1,buttons:[{text:vds.cache.get("CONFIRM_OK_LABEL"),"class":"btn btn--primary-ghost",click:function(){$(this).dialog("close")}}]});this.model.addEventListener("change",this)};vds.extend(vds.views.InfoView,vds.views.View);
vds.views.InfoView.prototype.handleEvent=function(){var a=this.model.getCurrent(),b=vds.cache.get("EXAM_OF_TOTAL").replace("TOTAL_PAGES",this.model.questions.length);vds.dom.empty(this.document.getElementById("pagerText")).appendChild(this.document.createTextNode(a.number+" "+b))};
vds.views.InfoView.prototype.updateTimeLeft=function(){var a=Math.max(this.model.endTime-Date.now(),0);vds.dom.empty(this.document.getElementById("timeleft")).appendChild(this.document.createTextNode(vds.date.formatTime(a)));6E5>a&&(this.warned||($("#timer").addClass("ui-state-error"),$("#tenminutewarning").dialog("open")),this.warned=!0);0>=a&&(this.model.submitted=!0,clearInterval(this.timeLeftInterval),vds.services.responseService.submitResponses(this.model,!0))};
vds.views.QuestionsView=function(a,b){vds.views.View.call(this,a,b);this.model.addEventListener("change",this);this.build()};vds.extend(vds.views.QuestionsView,vds.views.View);vds.views.QuestionsView.prototype.handleEvent=function(a){"change"==a.type&&this.update()};
vds.views.QuestionsView.prototype.build=function(){vds.dom.empty(this.element);for(var a=0;a<this.model.questions.length;a++){var b=this.model.questions[a],c=document.createElement("div");c.setAttribute("class","question");c.setAttribute("data-ident",b.id);this.element.appendChild(c)}};
vds.views.QuestionsView.prototype.update=function(){for(var a=this.element.querySelectorAll(".question"),b=0;b<a.length;b++)a[b].classList.add("hidden");if(a=this.model.getCurrent()){a=this.element.querySelector('[data-ident="'+a.id+'"]');a.scrollTop=0;a.scrollLeft=0;a.classList.remove("hidden");var b=a.querySelector(".item-long-description"),c=document.querySelector(".question:not(.hidden) .testlet-container input"),d=$(".question:not(.hidden) .options-list div[role=listitem]:first");b?b.focus():
c?c.focus():d&&d.focus();hljs&&(a=a.querySelectorAll("code"),0<a.length&&$(a).each(function(a,b){hljs.highlightBlock(b);var c=$(this).html(),d=c.match(/\s*\n[\t\s]*/);$(this).html(c.replace(RegExp(d,"g"),"\n"))}))}};vds.views.QuestionsView.prototype.getElementByQuestion=function(a){return this.element.querySelector('[data-ident="'+a.id+'"]')};
vds.views.NavBarView=function(a,b){vds.views.View.call(this,a,b);$("#previous").button({text:!1,position:"absolute"});$("#previous").click(function(){a.setCurrent(a.getPrevious())});$("#next").button({text:!1,position:"absolute"});$("#next").click(function(){a.setCurrent(a.getNext())});$("#submit").button({position:"absolute"});$("#submit").click(function(){a.submitted=!0;$(this).button("option","disabled",!0);ptapi.isLoaded()?ptapi.unloadPTItem(function(){vds.services.responseService.submitResponses(a)}):
vds.services.responseService.submitResponses(a)});this.dir=this.document.documentElement.getAttribute("dir");this.model.addEventListener("change",this);this.view.addEventListener("resize",this);this.build()};vds.extend(vds.views.NavBarView,vds.views.View);vds.views.NavBarView.prototype.handleEvent=function(a){"change"==a.type?this.update():"click"==a.type&&(a=a.target.getAttribute("data-ident"),this.model.setCurrent(vds.models.Question.map[a]))};
vds.views.NavBarView.prototype.build=function(){for(var a=vds.dom.empty(this.element.querySelector("#questionbarcontainer")),b=0;b<this.model.questions.length;b++){var c=this.model.questions[b],d=document.createElement("li");d.setAttribute("class","default");d.setAttribute("data-ident",c.id);var e=document.createElement("button");e.setAttribute("class","default");e.setAttribute("data-ident",c.id);e.setAttribute("aria-label","Question "+c.number);e.addEventListener("click",this);d.appendChild(e);a.appendChild(d)}var f=
this;$("#questionbarcontainer li").hover(function(){var a=this.getAttribute("data-ident"),a=vds.models.Question.map[a];f.setHover($(this),f.getHover(a))},function(){f.clearHover()});$("#questionbarcontainer li button").focus(function(){var a=this.getAttribute("data-ident"),a=vds.models.Question.map[a];f.setHover($(this),f.getHover(a))});$("#questionbarcontainer li button").focusout(function(){f.clearHover()});$("#previous").hover(function(){f.setHover($(this),vds.cache.get("previous"))},function(){f.clearHover()});
$("#previous").focus(function(){f.setHover($(this),vds.cache.get("previous"))});$("#previous").focusout(function(){f.clearHover()});$("#next").hover(function(){f.setHover($(this),vds.cache.get("next"))},function(){f.clearHover()});$("#next").focus(function(){f.setHover($(this),vds.cache.get("next"))});$("#next").focusout(function(){f.clearHover()});$("#submit").hover(function(){f.setHover($(this),vds.cache.get("submit"))},function(){f.clearHover()});$("#submit").focus(function(){f.setHover($(this),
vds.cache.get("submit"))});$("#submit").focusout(function(){f.clearHover()})};
vds.views.NavBarView.prototype.setHover=function(a,b){$("#hovertext").text(b);var c=a.attr("id");"previous"==c?(c="rtl"!=this.dir?"left":"right",$("#hovertext").position({my:c,at:c,of:a}),$("#hovertext").css({top:"2px"})):"next"==c?($("#hovertext").position({my:"center",at:"center",of:a}),$("#hovertext").css({top:"2px"})):"submit"==c?(c="rtl"!=this.dir?"right":"left",$("#hovertext").position({my:c,at:c,of:a}),$("#hovertext").css({top:"2px","margin-left":"-15px"})):$("#hovertext").position({my:"center",
at:"center",of:a,using:function(a){a=a.left;"rtl"==this.dir?(a=Math.min(a,-3),a=Math.max(a,3-($("#navbarhover").width()-$("#hovertext").width()))):(a=Math.max(a,3),a=Math.min(a,$("#navbarhover").width()-$("#hovertext").width()-3));$("#hovertext").css({top:"2px",left:a+"px"})}})};
vds.views.NavBarView.prototype.getHover=function(a){var b=a.number+": "+this.remapQuestionType(a.type);a.hasPTMO()&&(b+=" (PT)");var c=vds.cache.get("notviewed");a.isVisited()&&(c=vds.cache.get("unanswered"));a.isAnswered()&&(c=vds.cache.get("answered"));return b+(" - "+c)};vds.views.NavBarView.prototype.clearHover=function(){$("#hovertext").text(" ")};
vds.views.NavBarView.prototype.update=function(){var a=this.model.getCurrent(),b=$("#previous");a==this.model.firstQuestion?(b.button("option","disabled",!0),b.removeClass("ui-state-focus"),b.removeClass("ui-state-hover")):b.button("option","disabled",!1);b=$("#next");a==this.model.lastQuestion?(b.button("option","disabled",!0),b.removeClass("ui-state-focus"),b.removeClass("ui-state-hover")):b.button("option","disabled",!1);for(var b=this.element.querySelector("#questionbarcontainer"),c=0;c<b.childNodes.length;c++){var d=
b.childNodes.item(c),e=d.getAttribute("data-ident"),e=vds.models.Question.map[e],f="default";e==a?f="current":(e.isVisited()&&(f="visited"),e.isAnswered()&&(f="answered"));d.className=f}};vds.views.NavBarView.prototype.remapQuestionType=function(a){return"Passage"==a?"Testlet":a};
vds.views.PTMOView=function(a,b){vds.views.View.call(this,a,b);this.id=this.element.getAttribute("data-matpt-ident");this.build();var c=this;this.model.addEventListener("status",function(a){c.setPTStatus(a);c.update()});this.model.addEventListener("error",function(a,b){c.throwPTError(a,b)});this.model.addEventListener("clear",function(){c.closePT()})};vds.extend(vds.views.PTMOView,vds.views.View);
vds.views.PTMOView.prototype.build=function(){var a=this;vds.dom.empty(this.element);if("SUCCEEDED"==window.PT_INITIALIZATION_STATUS){$("#ptControls").clone().removeAttr("id").appendTo(this.element);var b=$(".ptShow",this.element),c=$(".ptHide",this.element),d=$(".ptShowRollover",this.element),e=$(".ptHideRollover",this.element),f=$(".ptError",this.element),g=$(".pt-error-close",this.element);b.button({disabled:!0});c.button({disabled:!0});b.click(function(){d.hide();a.model&&a.model.initializeStatus();
a.openPT()});c.click(function(){e.hide();a.closePT()});g.click(function(){f.hide();a.model&&a.model.initializeStatus();a.closePT()});b.hover(function(){d.show()},function(){d.hide()});c.hover(function(){e.show()},function(){e.hide()})}else $("#ptSkipped").clone().removeAttr("id").appendTo(this.element),$("#ptSkipped").clone().removeAttr("id").prependTo($(this.element).closest("form").find(".item-long-description"));this.update()};
vds.views.PTMOView.prototype.setPTStatus=function(a){if(this.model.getCurrent()==this.id){var b=$(".ptStatus",this.element);switch(a){case "empty":b.text("");b.hide();break;case "loading":b.text(vds.cache.get("pt_loading"));b.show();break;case "loaded":b.text(vds.cache.get("pt_loaded"));b.show();break;case "ready":b.text("");b.hide();break;case "visited":b.text("");b.hide();break;case "answered":b.text("");b.hide();break;case "saving":b.text(vds.cache.get("pt_saving"));b.show();break;case "saved":b.text(vds.cache.get("pt_saved"));
b.show();break;default:b.text(""),b.hide()}}};vds.views.PTMOView.prototype.throwPTError=function(a,b){if(this.model.getCurrent()==this.id){var c=this,d=$(".ptError",this.element),e=$(".pt-error-view-details",this.element);e.unbind("click");e.bind("click",function(){c.viewPTErrorDetails(a,b)});d.show()}};
vds.views.PTMOView.prototype.viewPTErrorDetails=function(a,b){vds.views.PTMOView.errorDialog||(vds.views.PTMOView.errorDialog=$("<div></div>").dialog({autoOpen:!1,modal:!0,width:600,open:function(){$(".ui-widget-overlay").bind("click",function(){$(this).siblings(".ui-dialog").find(".ui-dialog-content").dialog("close")})}}));var c=vds.cache.get("pt_error")+" "+a;vds.views.PTMOView.errorDialog.html('<div class="loading"></div>');vds.views.PTMOView.errorDialog.dialog("option","title",c).dialog("open");
this.model.fetchErrorMessage(a,b,function(a){a='<div class="pterror ui-widget ui-widget-content ui-corner-all ui-state-error">'+(a?a:vds.cache.get("pt_details_error"));vds.views.PTMOView.errorDialog.html(a+"</div>");a=vds.views.PTMOView.errorDialog.dialog("option","position");vds.views.PTMOView.errorDialog.dialog("option","position",a)})};
vds.views.PTMOView.prototype.openPT=function(){vds.views.PTMOView.disablePTControls();vds.logger.debug("openPT");this.model.isLoaded()&&this.closePT();this.model.loadPTItem(this.id,function(){vds.logger.debug("loadPTItem:callback")})};vds.views.PTMOView.prototype.closePT=function(){vds.views.PTMOView.disablePTControls();vds.logger.debug("closePT");this.model.unloadPTItem(function(){vds.logger.debug("unloadPTItem:callback")})};
vds.views.PTMOView.disablePTControls=function(){vds.logger.debug("disablePTControls");$("[data-matpt-ident] .ptShow").button("option","disabled",!0);$("[data-matpt-ident] .ptHide").button("option","disabled",!0)};vds.views.PTMOView.enablePTControls=function(){vds.logger.debug("enablePTControls");$("[data-matpt-ident] .ptShow").button("option","disabled",!1);$("[data-matpt-ident] .ptHide").button("option","disabled",!0);$("[data-matpt-ident] .ptStatus").hide();$("[data-matpt-ident] .ptError").hide()};
vds.views.PTMOView.prototype.update=function(){vds.views.PTMOView.disablePTControls();var a=this.model.getCurrent()==this.id,b=this.model.isLoaded(),c=this.model.getStatus();"ready"==c?b?($(".ptShow",this.element).button("option","disabled",!0),$(".ptHide",this.element).button("option","disabled",!a)):($(".ptShow",this.element).button("option","disabled",!1),$(".ptHide",this.element).button("option","disabled",!0),$(".ptStatus",this.element).hide(),$(".ptError",this.element).hide()):"error"==c?b?
($(".ptShow",this.element).button("option","disabled",!0),$(".ptHide",this.element).button("option","disabled",!0)):($(".ptShow",this.element).button("option","disabled",!1),$(".ptHide",this.element).button("option","disabled",!0),$(".ptStatus",this.element).hide(),$(".ptError",this.element).hide()):($(".ptShow",this.element).button("option","disabled",!0),$(".ptHide",this.element).button("option","disabled",!0))};vds.provide("vds.services");
vds.services.responseService=new function(){var a=function(a,c){var d=document.createElement("input");d.setAttribute("type","hidden");d.setAttribute("name",a);d.setAttribute("value",c);return d};this.sendResponses=function(b,c){vds.logger.debug("send responses for question #"+b.number+" ["+b.id+"]");var d=document.createElement("form");d.appendChild(a("SLIX",vds.cache.get("SLIX")));d.appendChild(a("BUTTON","go1"));d.appendChild(a("PAGE_NUMBER","1"));d.appendChild(a("pauseexam",c));for(var e=b.getResponses(),
f=0;f<e.length;f++){var g=e[f];d.appendChild(a(g.name,g.value))}var h=$(d).serialize();vds.tasks.add(function(a){vds.logger.debug("sending responses for question #"+b.number+" ["+b.id+"]");jQuery.ajax({type:"POST",url:"exam.html",data:h,async:!0,cache:!1,timeout:1E4,success:function(){vds.logger.debug("sent responses for question #"+b.number+" ["+b.id+"]");a()},error:function(){vds.logger.error("unable to send responses for question #"+b.number+" ["+b.id+"]");a();$(".question.loading").addClass("hidden");
$(".question.loading").removeClass("loading");$("#error-dialog").dialog({autoOpen:!0,modal:!0,resizable:!1,draggable:!1,buttons:[{text:vds.cache.get("CONFIRM_OK_LABEL"),"class":"btn btn--primary-ghost",click:function(){$(this).dialog("close")}}]})}})})};this.submitResponses=function(b,c){var d=document.createElement("form");d.setAttribute("action","exam.html");d.setAttribute("method","POST");d.appendChild(a("SLIX",vds.cache.get("SLIX")));d.appendChild(a("BUTTON",c?"expired":"submit"));d.appendChild(a("PAGE_NUMBER",
"1"));window.PT_INITIALIZATION_STATUS&&d.appendChild(a("PT_INITIALIZATION_STATUS",window.PT_INITIALIZATION_STATUS));for(var e=0;e<b.questions.length;e++){var f=b.questions[e];if(f.isLoaded())for(var f=f.getResponses(),g=0;g<f.length;g++){var h=f[g];d.appendChild(a(h.name,h.value))}}document.body.appendChild(d);d.submit()};this.getResponses=function(a){var c=[],d=document.querySelector('form[name="'+a.id+'"]'),e=a.response_id;if("FIB"==a.type){for(var f=a.response_labels[1],g="",h=0;h<d.elements.length;h++)if(a=
d.elements[h],"text"==a.type||"textarea"==a.type){g=encodeURIComponent(a.value);break}c.push(new vds.models.Response(e,f+"="+g))}else if("TF"==a.type||"MCSA"==a.type||"SVRAT"==a.type){f=a.response_labels[1];g="";if("dropdown"==a.display)h=d[a.response_id],g=h.options[h.selectedIndex].value;else for(h=0;h<d.elements.length;h++)if(a=d.elements[h],a.checked){g=a.value;break}c.push(new vds.models.Response(e,f+"="+g))}else if("MCMA"==a.type){f=a.response_labels[1];for(h=0;h<d.elements.length;h++)g="",
a=d.elements[h],a.value&&(a.checked&&(g=a.value),c.push(new vds.models.Response(e,f+"="+g)))}else if("SVTXT"==this.type)f=a.response_labels[1],g=encodeURIComponent(d.elements[0].value),c.push(new vds.models.Response(e,f+"="+g));else if("SSI"==a.type||"SST"==a.type)for(h=1;h<=a.numresp;h++)f=a.response_labels[h],g=a.response_array[h],""==g||" "==g||"null"==g?c.push(new vds.models.Response(e,f+"=SSAI_HACK")):(g==decodeURIComponent(g)&&(g=encodeURIComponent(g)),c.push(new vds.models.Response(e,f+"="+
g)));else if("Passage"==a.type)for(h=0;h<a.testletChildren.length;h++)e=this.getResponses(Question[a.testletChildren[h]]),c=c.concat(e);return c};this.hasResponses=function(a){var c=document.querySelector('form[name="'+a.id+'"]');if(0<c.querySelectorAll("input:checked").length)return!0;for(var d=c.querySelectorAll('input[type="text"]'),e=0;e<d.length;e++)if(""!=d[e].value)return!0;c=c.querySelectorAll("textarea");for(e=0;e<c.length;e++)if(""!=c[e].value)return!0;if("SSI"==a.type)for(e=1;e<a.response_array.length;e++){if(""!=
a.response_array[e])return!0}else if("Passage"==a.type){c=!0;for(e=0;e<a.testletChildren.length;e++)if(!this.hasResponses(Question[a.testletChildren[e]])){c=!1;break}if(c)return!0}return!1}};
vds.services.pingServices=new function(){var a=this;this.interval=setInterval(function(){a.ping()},3E5);this.ping=function(){vds.logger.debug("ping");vds.tasks.add(function(a){vds.logger.debug("pinging");jQuery.ajax({type:"GET",url:"exam_ping.html",data:vds.cache.has("SLIX")?"SLIX="+vds.cache.get("SLIX"):"",cache:!1,timeout:1E4,success:function(){vds.logger.debug("pinged");a()},error:function(){vds.logger.warn("unable to ping");a()}})})}};
vds.services.renderServices=new function(){var a=document.documentElement.getAttribute("dir")||"ltr";this.render=function(){$("#navbar").height(40);$("#navbar").css({position:"absolute",width:$("#breadcrumbs").width(),top:$(window).height()-$("#navbar").height()-5});$("#questions").css({position:"absolute",width:$("#breadcrumbs").width()-6,height:"200px"});$("#questions").position({my:"left top",at:"left bottom",of:$("#examHr"),offset:"0 0"});$("#navbarhover").css({position:"absolute",width:$("#navbar").width(),
height:"20px","padding-left":"0px","padding-right":"0px"});$("#navbarhover").position({my:"left bottom",at:"left top",of:$("#navbar"),offset:"0 -1"});$("#submit").position({my:"rtl"!=a?"right center":"left center",at:"rtl"!=a?"right center":"left center",of:$("#navbar"),collision:"none"});"rtl"!=a&&$("#submit").css("margin-left","-5px");$("#previous").position({my:"rtl"!=a?"left center":"right center",at:"rtl"!=a?"left center":"right center",of:$("#navbar"),collision:"none"});"rtl"!=a&&$("#previous").css("left",
"5px");$("#next").position({my:"rtl"!=a?"left center":"right center",at:"rtl"!=a?"right center":"left center",of:$("#previous"),collision:"none"});"rtl"!=a&&$("#next").css("left","5px");var b;b="rtl"!=a?$("#submit").position().left-10-($("#next").position().left+$("#next").width()+10):$("#next").position().left-10-($("#submit").position().left+$("#submit").width()+10);$("#questionbar").css({position:"absolute",width:b,cursor:"pointer"});$("#questionbar").position({my:"left center",at:"right center",
of:"rtl"!=a?$("#next"):$("#submit"),offset:"10 0",collision:"none"});"rtl"!=a&&$("#questionbar").css("left",$("#next").position().left+$("#next").width()+10);b=$("#questions").position().top;var c=$("#navbarhover").position().top-10;vds.logger.debug("t b height: "+b+" "+c+" "+(c-b));$("#questions").height(c-b);$("#submit").insertAfter("#questionbar")}};